<% layout("layouts/boilerplate") %>

<h1 class="text-center mb-3">スポット情報</h1>
<% for(let i = 0; i < spots.length && i < 5; i++) { %>
<div class="card mb-4 container mx-auto" >
  <div class="row" id="index-row">
    <div class="col-md-5">
      <% if (spots[i].images && spots[i].images.length > 0) { %>
        <img src="<%= spots[i].images[0].url %>" alt="..." class="img-fluid">
      <% } else { %>
        <img src="https://res.cloudinary.com/dhlpu00lv/image/upload/v1740789149/YelpCamp/t8y4sq8oumsv2hjn0j29.jpg" alt="デフォルト画像" class="img-fluid">
      <% } %>
    </div>
    <div class="col-md-7 index-card">
      <div class="card-body d-flex flex-column justify-content-around index-card-body">
        <h5 class="card-title"><%= spots[i].title %></h5>
        <p class="card-text"><%= spots[i].location %></p>
        <p class="card-text"><%= spots[i].description %></p>
        <a href="/spots/<%= spots[i]._id %>" class="btn btn-info w-25 rounded-pill">詳細を見る</a>
      </div>
    </div>
  </div>
</div>
<% } %>
<div class="d-grid gap-2 col-4 mx-auto mb-3">
  <a href="/spots/list" class="w-100 btn btn-success rounded-pill">
    もっと見る
  </a>
</div>

<div class="my-5">
  <p class="text-center">地図から選択する</p>
  <div id="cluster-map" class="container mt-3"></div>
</div>

<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v1.0.0/mapbox-gl-language.js'></script>
<script>
  const mapToken = '<%= process.env.MAPBOX_TOKEN %>';
  const spots = <%- JSON.stringify(spots) %>
</script>

<script src="/javascripts/clusterMap.js"></script>

